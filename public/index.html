<!DOCTYPE html>
<html>
  <head>
    <title>Divide Conta</title>
    <meta charset="UTF-8">
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900|Material+Icons" rel="stylesheet" type="text/css">
    <link href="https://use.fontawesome.com/releases/v6.1.1/css/all.css" rel="stylesheet" type="text/css">
    <link href="https://cdn.jsdelivr.net/npm/quasar@2.8.3/dist/quasar.prod.css" rel="stylesheet" type="text/css">
    <link href="index.css" rel="stylesheet" type="text/css">
  </head>

  <body class="row justify-center">
    <!-- example of injection point where you write your app template -->
    <div id="q-app" class="row items-start q-pa-md" style="max-width: 900px;">
        
        <h3>Divide Conta v1.0</h3>

        <div class="bg-light-blue-1 text-body1 full-width q-pa-md">
          Informe os dados dos itens para calcular o valor de cada participante
        </div>
        
        <h5>Itens/Produtos Comprados</h5>
        <div class="row col-12 q-gutter-sm">
          <q-input outlined v-model="itensModel.entry.descricao" label="Descrição do Item/Produto" class="col-12 col-md-5" ref="txtDescricaoItem" @keypress.enter="$refs.addItem.click()"></q-input>
          <q-input outlined v-model="itensModel.entry.valor" label="Valor R$" class="col-12 col-md-2" @keypress.enter="$refs.addItem.click()"></q-input>
          <q-input outlined v-model="itensModel.entry.solicitante" label="Solicitante" class="col-12 col-md-3" @keypress.enter="$refs.addItem.click()"></q-input>
          <q-btn ref="addItem" size="lg" color="secondary" @click="e => itensModel.addItem(e)" :icon="itensModel.isNewItem()?'add':'check'"></q-btn>
        </div>

        <q-table :rows="itensModel.items" :columns="[ 
              { name: 'descricao', label: 'Item', align: 'left', field: row => row.descricao }, 
              { name: 'valor', label: 'Valor R$', align: 'right', field: row => row.valor }, 
              { name: 'solicitante', label: 'Solicitante', align: 'left', field: row => row.solicitante },
              { name: 'actions' }
          ]" :pagination="itensModel.pagination" class="full-width q-mt-md" hide-bottom row-key="id" 
          v-show="itensModel.items.length > 0">
          <template v-slot:body-cell-actions="props">
            <q-td :props="props">
              <q-btn flat icon="edit" @click="itensModel.editItem(props.row)"></q-btn>
              <q-btn flat icon="delete" color="red" @click="itensModel.removeItem(props.row)"></q-btn>
            </q-td>
          </template>
        </q-table>        

        <div class="row col-12 col-md-6 items-start">
          <h5>Acréscimo(s)</h5>

          <div class="row full-width">
            <q-input outlined dense v-model="acrescimosModel.entry.descricao" label="Descrição" class="col-7" ref="txtDescricaoAcrescimo" @keypress.enter="$refs.addAcrescimo.click()"></q-input>
            <q-input outlined dense v-model="acrescimosModel.entry.valor" label="Valor" class="col-2" @keypress.enter="$refs.addAcrescimo.click()"></q-input>
            <q-input outlined dense v-model="acrescimosModel.entry.solicitante" class="col-1" @keypress.enter="$refs.addAcrescimo.click()"></q-input>

            <q-btn ref="addAcrescimo" color="secondary" @click="e => acrescimosModel.addItem(e)" size="sm" icon="add"></q-btn>
          </div>

          <q-table :rows="acrescimosModel.items" flat :columns="[ 
                { name: 'descricao', label: 'Item', align: 'left', field: row => row.descricao }, 
                { name: 'valor', label: 'Valor', align: 'right', field: row => row.valor }, 
                { name: 'actions' }
            ]"
            :pagination="acrescimosModel.pagination" class="full-width q-mt-md" 
            hide-bottom hide-header row-key="id" 
            v-show="acrescimosModel.items.length > 0">
            <template v-slot:body-cell-actions="props">
              <q-td :props="props">
                <q-btn flat icon="edit" @click="acrescimosModel.editItem(props.row)"></q-btn>
                <q-btn flat icon="delete" color="red" @click="acrescimosModel.removeItem(props.row)"></q-btn>
              </q-td>
            </template>
              
          </q-table>    
        </div>

        <div class="row col-12 col-md-6 items-start">
          <h5>Desconto(s)</h5>

          <div class="row full-width">
            <q-input outlined dense v-model="descontosModel.entry.descricao" label="Descrição" class="col-7" ref="txtDescricaoDesconto" @keypress.enter="$refs.addDesconto.click()"></q-input>
            <q-input outlined dense v-model="descontosModel.entry.valor" label="Valor" class="col-2" @keypress.enter="$refs.addDesconto.click()"></q-input>
            <q-input outlined dense v-model="descontosModel.entry.solicitante" class="col-1" @keypress.enter="$refs.addDesconto.click()" flat></q-input>

            <q-btn ref="addDesconto" color="secondary" @click="e => descontosModel.addItem(e)" size="sm" icon="add"></q-btn>
          </div>

          <q-table :rows="descontosModel.items" flat :columns="[ 
                { name: 'descricao', label: 'Item', align: 'left', field: row => row.descricao }, 
                { name: 'valor', label: 'Valor R$', align: 'right', field: row => row.valor }, 
                { name: 'actions' }
            ]"
            :pagination="descontosModel.pagination" class="full-width q-mt-md" 
            hide-bottom hide-header :columns="columns" row-key="id" 
            v-show="descontosModel.items.length > 0">
            <template v-slot:body-cell-actions="props">
              <q-td :props="props">
                <q-btn flat icon="edit" @click="descontosModel.editItem(props.row)"></q-btn>
                <q-btn flat icon="delete" color="red" @click="descontosModel.removeItem(props.row)"></q-btn>
              </q-td>
            </template>
              
          </q-table>    
        </div>
        
        <div class="row full-width q-mt-xl q-gutter-md justify-end">
          <q-btn size="lg" color="primary" icon="calculate" @click="calcular">&nbsp;Calcular</q-btn>
          <q-btn size="lg" color="grey" flat icon="backspace" @click="limpar">&nbsp;Limpar</q-btn>
        </div>

        <div class="row" v-if="divisaoDTO != null">
          <h5>Resultado da Divisão</h5>

          <q-table :rows="divisaoDTO.divisoes" flat :columns="[ 
                { label: 'Participante', align: 'left', field: row => row.participante }, 
                { label: 'Valor Itens', align: 'right', field: row => row.valorItens }, 
                { name: 'Descontos', label: 'Valor', align: 'right', field: row => row.descontos }, 
                { name: 'Acréscimos', label: 'Valor', align: 'right', field: row => row.acrescimos }, 
                { label: 'Valor Pagar', align: 'right', field: row => row.valorAPagar }, 
                
                { name: 'actions' }
            ]"
            :pagination="divisoesPagination" class="full-width q-mt-md" 
            hide-bottom hide-header row-key="participante" >
            <template v-slot:body-cell-actions="props">
              <q-td :props="props">
                <q-btn flat icon="payment" @click="pagar(props.row)"></q-btn>                
              </q-td>
            </template>
              
          </q-table>   
        </div>

    </div>

    <!-- Add the following at the end of your body tag -->
    <script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.prod.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/quasar@2.8.3/dist/quasar.umd.prod.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    
    <script src="index.js" type="text/javascript"></script>
  </body>
</html>